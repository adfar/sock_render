<!DOCTYPE html>
<html lang="en">
    <head>
        <title>üé° Sweet Treats Pavilion üç≠</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
        <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
        <script>
            const socket = io();
        </script>
    </head>
    <body id="main">
        <header class="park-header">
            <h1 class="main-title">üé° Sweet Treats Pavilion üç≠</h1>
            <p class="park-subtitle">Delicious treats for your magical day!</p>
        </header>
        <div class="columns">
            <div class="column">
                <div class="group">
                    <div class="items">
                        <h1 class="title">üç´ Fresh Fudge!</h1>
                        {% for item in fudges %}
                            <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span> 
                                <span class="price">
                                {% if not item.status %}
                                    Sold Out
                                {% else %}
                                    {{ item.price }}
                                {% endif %}
                                </span>
                            </div>
                        {% endfor %}
                        <img id="fudge_img" src="/static/PBC.png">
                    </div>
                    <div class="items">
                        <h1 class="title">üçì Chocolate Dipped Treats!</h1>
                        {% for item in chocolates %}
                            <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span>
                                <span class="price">
                                    {% if not item.status %}
                                        Sold Out
                                    {% else %}
                                        {{ item.price }}
                                    {% endif %}
                                </span>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="column">
                    <div class="group">
                        <div class="items">
                            <h1 class="title">üçé Caramel Apples!</h1>
                            {% for item in apples %}
                                <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span>
                                    <span class="price">
                                        {% if not item.status %}
                                            Sold Out
                                        {% else %}
                                            {{ item.price }}
                                        {% endif %}
                                    </span>
                                </div>
                            {% endfor %}
                        </div>
                        <img id="caramel_img" src="/static/caramel.png">
                        <div class="items">
                            <h1 class="title">üç¨ Candy Wonderland!</h1>
                            {% for item in candies %}
                                <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span>
                                    <span class="price">
                                        {% if not item.status %}
                                            Sold Out
                                        {% else %}
                                            {{ item.price }}
                                        {% endif %}
                                    </span>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div id="special">
                        <div class="special-text">üéâ Buy Four Pieces üéâ</div>
                        <div class="fudge-special">üç´ Fudge Special! üç´</div>
                        <div class="special-text">‚≠ê Get Two Free! ‚≠ê</div>
                    </div>
                </div>
            <div class="column">
                <div class="group">
                    <h1 class="title">ü•§ Refreshing Beverages!</h1>
                    {% for item in drinks %}
                        <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span>
                            <span class="price">
                                {% if not item.status %}
                                    Sold Out
                                {% else %}
                                    {{ item.price }}
                                {% endif %}
                            </span>
                        </div>
                    {% endfor %}
                    <ul id="beverages">
                        {% for item in bevs %}
                        <li>
                            <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item">
                                <span class="item_name">{{ item.name }}</span>
                                <span class="price">
                                    {% if not item.status %}
                                        Sold Out
                                    {% endif %}
                                </span>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </body>
    <script>
        socket.on('out', ev => {
            let name = ev.name;
            let price = ev.price;
            let status = ev.status;
            if (status === false) {
                let item = document.getElementById(name);
                item.classList.replace("true", "false");
                item.children[1].innerHTML = 'Sold Out';
            }
            else if (status === true) {
                let item = document.getElementById(name);
                item.classList.replace("false", "true");
                item.children[1].innerHTML = price > 0 ? price : '';
            }
        });
    </script>
</html>