<!DOCTYPE html>
<html lang="en">
    <head>
        <title>üé° Sweet Treats Pavilion üç≠</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
        <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
        <script>
            const socket = io();
        </script>
    </head>
    <body id="main">
        <header class="park-header">
            <h1 class="main-title">üé° Sweet Treats Pavilion üç≠</h1>
            <p class="park-subtitle">Delicious treats for your magical day!</p>
        </header>
        <div class="columns">
            <div class="column">
                <div class="group">
                    <div class="items">
                        <h1 class="title">üç´ Fresh Fudge!</h1>
                        {% for item in fudges %}
                            <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span> 
                                <span class="price">
                                {% if not item.status %}
                                    Sold Out
                                {% else %}
                                    {{ item.price }}
                                {% endif %}
                                </span>
                            </div>
                        {% endfor %}
                        <img id="fudge_img" src="/static/PBC.png">
                    </div>
                    <div class="items">
                        <h1 class="title">üçì Chocolate Dipped Treats!</h1>
                        {% for item in chocolates %}
                            <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span>
                                <span class="price">
                                    {% if not item.status %}
                                        Sold Out
                                    {% else %}
                                        {{ item.price }}
                                    {% endif %}
                                </span>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="column">
                    <div class="group">
                        <div class="items">
                            <h1 class="title">üçé Caramel Apples!</h1>
                            {% for item in apples %}
                                <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span>
                                    <span class="price">
                                        {% if not item.status %}
                                            Sold Out
                                        {% else %}
                                            {{ item.price }}
                                        {% endif %}
                                    </span>
                                </div>
                            {% endfor %}
                        </div>
                        <img id="caramel_img" src="/static/caramel.png">
                        <div class="items">
                            <h1 class="title">üç¨ Candy Wonderland!</h1>
                            {% for item in candies %}
                                <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span>
                                    <span class="price">
                                        {% if not item.status %}
                                            Sold Out
                                        {% else %}
                                            {{ item.price }}
                                        {% endif %}
                                    </span>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <svg id="special" viewBox="0 0 500 350" style="background: none;">
                        <defs>
                            <linearGradient id="specialGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#ffd93d;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#ff6b6b;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="textGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#d32f2f;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#1976d2;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path id="top" d="M 70 145 a 180 120 0 0 1 360, 0"/>
                        <path id="bottom" d="M 70 205 a 180 120 0 0 0 360, 0"/>
                        <ellipse cx="250" cy="175" rx="220" ry="148" fill="url(#specialGrad)" stroke="#fff" stroke-width="4"/>
                        <text text-anchor="middle" font-size="22px" font-family="Comic Sans MS, cursive" font-weight="bold" fill="#fff" stroke="#000" stroke-width="0.5">
                            <textPath href="#top" startOffset="50%">
                                üéâ Buy Four Pieces üéâ
                            </textPath>
                            <textPath href="#bottom" startOffset="50%">
                                ‚≠ê Get Two Free! ‚≠ê
                            </textPath>
                        </text>
                        <style>
                            #fudge_special {font: bold 42px 'Comic Sans MS', cursive; fill: url(#textGrad); stroke: #fff; stroke-width: 1;}
                        </style>
                        <text id="fudge_special" x="250" y="175" text-anchor="middle" dominant-baseline="central">üç´ Fudge Special! üç´</text>
                    </svg>
                </div>
            <div class="column">
                <div class="group">
                    <h1 class="title">ü•§ Refreshing Beverages!</h1>
                    {% for item in drinks %}
                        <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item"><span class="item_name">{{ item.name }}</span>
                            <span class="price">
                                {% if not item.status %}
                                    Sold Out
                                {% else %}
                                    {{ item.price }}
                                {% endif %}
                            </span>
                        </div>
                    {% endfor %}
                    <ul id="beverages">
                        {% for item in bevs %}
                        <li>
                            <div id="{{ item.name }}" class="{{ item.status|string|lower }} menu_item">
                                <span class="item_name">{{ item.name }}</span>
                                <span>
                                    {% if not item.status %}
                                        Sold Out
                                    {% endif %}
                                </span>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </body>
    <script>
        socket.on('out', ev => {
            let name = ev.name;
            let price = ev.price;
            let status = ev.status;
            if (status === false) {
                let item = document.getElementById(name);
                item.classList.replace("true", "false");
                item.children[1].innerHTML = 'Sold Out';
            }
            else if (status === true) {
                let item = document.getElementById(name);
                item.classList.replace("false", "true");
                item.children[1].innerHTML = price > 0 ? price : '';
            }
        });
    </script>
</html>